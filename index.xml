<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Chiyuki の CS Blog ですわ</title><link>https://nizigen.github.io/algolia.json</link><description>Recent content from Chiyuki の CS Blog ですわ</description><generator>Hugo</generator><language>en-us</language><managingEditor>l12345p9876x0@gmail.com (Chiyuki)</managingEditor><webMaster>l12345p9876x0@gmail.com (Chiyuki)</webMaster><copyright>All articles on this blog are licensed under the BY-NC-SA license agreement unless otherwise stated. Please indicate the source when reprinting!</copyright><lastBuildDate>Mon, 29 Sep 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://nizigen.github.io/index.xml" rel="self" type="application/rss+xml"/><item><title>如何在自己的博客页面使用自己的live2d模型</title><link>https://nizigen.github.io/post/%E5%A6%82%E4%BD%95%E5%9C%A8%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2%E9%A1%B5%E9%9D%A2%E4%BD%BF%E7%94%A8%E8%87%AA%E5%B7%B1%E7%9A%84live2d%E6%A8%A1%E5%9E%8B/</link><pubDate>Mon, 29 Sep 2025 00:00:00 +0000</pubDate><author>l12345p9876x0@gmail.com (Chiyuki)</author><guid>https://nizigen.github.io/post/%E5%A6%82%E4%BD%95%E5%9C%A8%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2%E9%A1%B5%E9%9D%A2%E4%BD%BF%E7%94%A8%E8%87%AA%E5%B7%B1%E7%9A%84live2d%E6%A8%A1%E5%9E%8B/</guid><description>
<![CDATA[<h1>如何在自己的博客页面使用自己的live2d模型</h1><p>Author: Chiyuki(l12345p9876x0@gmail.com)</p>
        
          <h1 id="如何在自己的博客页面使用自定义live2d模型">
<a class="header-anchor" href="#%e5%a6%82%e4%bd%95%e5%9c%a8%e8%87%aa%e5%b7%b1%e7%9a%84%e5%8d%9a%e5%ae%a2%e9%a1%b5%e9%9d%a2%e4%bd%bf%e7%94%a8%e8%87%aa%e5%ae%9a%e4%b9%89live2d%e6%a8%a1%e5%9e%8b"></a>
如何在自己的博客页面使用自定义Live2D模型
</h1><p>在Hugo站点（我使用的是Reimu主题，其他主题也是同理的）中集成自定义Live2D模型，需要配置资源加载、处理CDN问题和大文件等。下面是详细步骤，基于我的实际经验（包括模型加载失败、CDN加载失败、GitHub Raw 400错误和大文件限制等等问题）。</p>
<h2 id="1-准备live2d资源">
<a class="header-anchor" href="#1-%e5%87%86%e5%a4%87live2d%e8%b5%84%e6%ba%90"></a>
1: 准备Live2D资源
</h2><ol>
<li>
<p><strong>创建GitHub仓库</strong>：新建一个公开仓库（如<code>your_github_username/live2d_api</code>），下载live2d-api仓库的model文件夹以及model.json文件上传到新建仓库。后续对应的文件目录结构也要参考这个库下面的教程。<img src="https://pic1.imgdb.cn/item/68da94a0c5157e1a88464572.png" alt="">
下载live2d-widget库下dist文件夹的所有内容，上传到仓库。确保分支为<code>main</code>。<img src="https://pic1.imgdb.cn/item/68da9463c5157e1a8846435e.png" alt="">
如果要上传自己的Live2D模型文件（.moc3、.json、纹理图片等)，只需要薅来的模型文件中把model.json或者说model3.json改名为index.json就可以了，但是注意命名不要有中文，会出现乱码。当然上传了新模型的话，对应的modellist也需要对应修改，这部分很简单，可以直接参考live2d-api仓库的教程。</p>
</li>
<li>
<p><strong>关键文件</strong>：</p>
<ul>
<li><code>waifu-tips.json</code>：交互框内容。（我是下载下来按照自己喜好修改了，如果你觉得原来的也行的话，就用源仓库的也行）。</li>
<li><code>waifu.css</code> 和 <code>waifu-tips.js</code>：样式和模型加载脚本。</li>
<li><code>modellist.json</code>:模型存放信息，用于加载模型。</li>
</ul>
</li>
<li>
<p><strong>关于访问</strong>：
每次上传了新的模型，需要点击该仓库的tag，然后新建release，只有这样后续才能使用cdn链接加载你的模型。
<img src="https://pic1.imgdb.cn/item/68da9412c5157e1a884640b7.png" alt=""></p>
</li>
</ol>
<p>注意：仓库必须公开，否则Raw访问会返回400 Bad Request。如果你想吃现成的话当然也可以直接照抄我的仓库，也有一些我嫖到的免费模型:<a href="https://github.com/nizigen/live2d_api">live2d_api</a></p>
<h2 id="2-配置reimu主题中的live2d">
<a class="header-anchor" href="#2-%e9%85%8d%e7%bd%aereimu%e4%b8%bb%e9%a2%98%e4%b8%ad%e7%9a%84live2d"></a>
2: 配置Reimu主题中的Live2D
</h2><p>Reimu主题内置Live2D支持（在<code>themes/reimu/static/resources/live2d-widgets@0.9.0/autoload.js</code>）。别的主题也应该有，如果没有的话可以把live2d-widget仓库下载下来把autoload.js保存到跟这个主题对应的位置。我的autoload.js是已经修改过的，所以说可能和原版不太一样，如果原版的不太行的话，可以尝试一下我的：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// live2d_path 参数建议使用绝对路径
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">live2d_path</span> <span class="o">=</span> <span class="s2">&#34;https://fastly.jsdelivr.net/npm/live2d-widgets@1.0.0-rc.7/dist/&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 封装异步加载资源的方法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">loadExternalResource</span> <span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nx">tag</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="s2">&#34;css&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">tag</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&#34;link&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">tag</span><span class="p">.</span><span class="nx">rel</span> <span class="o">=</span> <span class="s2">&#34;stylesheet&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nx">tag</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">url</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="s2">&#34;js&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">tag</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&#34;script&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">tag</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;module&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nx">tag</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">url</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">tag</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">tag</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="nx">resolve</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">tag</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="nx">reject</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nb">document</span><span class="p">.</span><span class="nx">head</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">tag</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 避免跨域图片资源问题
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">OriginalImage</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Image</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nb">window</span><span class="p">.</span><span class="nx">Image</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(...</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">img</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OriginalImage</span><span class="p">(...</span><span class="nx">args</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nx">img</span><span class="p">.</span><span class="nx">crossOrigin</span> <span class="o">=</span> <span class="s2">&#34;anonymous&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">img</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nb">window</span><span class="p">.</span><span class="nx">Image</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">OriginalImage</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 加载 waifu.css 和 waifu-tips.js
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">(</span><span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 备用CDN列表，如果主CDN无法访问会自动尝试备用CDN
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">const</span> <span class="nx">cdnList</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;https://fastly.jsdelivr.net/gh/nizigen/live2d_api@v1.4/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;https://cdn.jsdelivr.net/gh/nizigen/live2d_api@v1.4/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;https://raw.githubusercontent.com/nizigen/live2d_api/v1.4/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;https://gcore.jsdelivr.net/gh/nizigen/live2d_api@v1.4/&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">currentCdnIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">loadSuccess</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// 尝试加载资源的函数，支持本地优先+CDN回退
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">async</span> <span class="kd">function</span> <span class="nx">tryLoadResources</span> <span class="p">(</span><span class="nx">cdnUrl</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 优先尝试加载本地CSS
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="kd">let</span> <span class="nx">cssPromise</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">cssPromise</span> <span class="o">=</span> <span class="nx">loadExternalResource</span><span class="p">(</span><span class="s2">&#34;/waifu.css&#34;</span><span class="p">,</span> <span class="s2">&#34;css&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;尝试加载本地CSS: /waifu.css&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">localError</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">&#34;本地CSS加载失败，使用CDN:&#34;</span><span class="p">,</span> <span class="nx">localError</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">cssPromise</span> <span class="o">=</span> <span class="nx">loadExternalResource</span><span class="p">(</span><span class="nx">cdnUrl</span> <span class="o">+</span> <span class="s2">&#34;waifu.css&#34;</span><span class="p">,</span> <span class="s2">&#34;css&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="kr">await</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">all</span><span class="p">([</span>
</span></span><span class="line"><span class="cl">        <span class="nx">cssPromise</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">loadExternalResource</span><span class="p">(</span><span class="nx">cdnUrl</span> <span class="o">+</span> <span class="s2">&#34;waifu-tips.js&#34;</span><span class="p">,</span> <span class="s2">&#34;js&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">]);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">loadSuccess</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">cdnUrl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="sb">`CDN </span><span class="si">${</span><span class="nx">cdnUrl</span><span class="si">}</span><span class="sb"> 加载失败，尝试下一个...`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// 尝试所有CDN直到成功或全部失败
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="nx">loadSuccess</span> <span class="o">&amp;&amp;</span> <span class="nx">currentCdnIndex</span> <span class="o">&lt;</span> <span class="nx">cdnList</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">tryLoadResources</span><span class="p">(</span><span class="nx">cdnList</span><span class="p">[</span><span class="nx">currentCdnIndex</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`成功使用CDN: </span><span class="si">${</span><span class="nx">result</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">currentCdnIndex</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">loadSuccess</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&#34;所有CDN都无法访问，Live2D功能将被禁用&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">workingCdn</span> <span class="o">=</span> <span class="nx">cdnList</span><span class="p">[</span><span class="nx">currentCdnIndex</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// 配置选项的具体用法见 README.md
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;初始化Live2D Widget...&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;工作CDN:&#34;</span><span class="p">,</span> <span class="nx">workingCdn</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;waifu-tips.json路径:&#34;</span><span class="p">,</span> <span class="nx">workingCdn</span> <span class="o">+</span> <span class="s2">&#34;waifu-tips.json&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">initWidget</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">waifuPath</span><span class="o">:</span> <span class="nx">workingCdn</span> <span class="o">+</span> <span class="s2">&#34;waifu-tips.json&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">cdnPath</span><span class="o">:</span> <span class="nx">workingCdn</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">cubism2Path</span><span class="o">:</span> <span class="nx">live2d_path</span> <span class="o">+</span> <span class="s2">&#34;live2d.min.js&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">cubism5Path</span><span class="o">:</span> <span class="s2">&#34;https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">tools</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;hitokoto&#34;</span><span class="p">,</span> <span class="s2">&#34;asteroids&#34;</span><span class="p">,</span> <span class="s2">&#34;switch-model&#34;</span><span class="p">,</span> <span class="s2">&#34;switch-texture&#34;</span><span class="p">,</span> <span class="s2">&#34;photo&#34;</span><span class="p">,</span> <span class="s2">&#34;info&#34;</span><span class="p">,</span> <span class="s2">&#34;quit&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="nx">logLevel</span><span class="o">:</span> <span class="s2">&#34;info&#34;</span><span class="p">,</span> <span class="c1">// 改为info级别以获得更多调试信息
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nx">drag</span><span class="o">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Live2D Widget初始化完成&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 添加必要的CSS样式确保Live2D正确显示
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kr">const</span> <span class="nx">style</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">style</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="sb">`
</span></span></span><span class="line"><span class="cl"><span class="sb">      #waifu.waifu-active {
</span></span></span><span class="line"><span class="cl"><span class="sb">        bottom: 0 !important;
</span></span></span><span class="line"><span class="cl"><span class="sb">        transform: translateY(0) !important;
</span></span></span><span class="line"><span class="cl"><span class="sb">      }
</span></span></span><span class="line"><span class="cl"><span class="sb">      #waifu.waifu-hidden {
</span></span></span><span class="line"><span class="cl"><span class="sb">        bottom: -1000px !important;
</span></span></span><span class="line"><span class="cl"><span class="sb">      }
</span></span></span><span class="line"><span class="cl"><span class="sb">      #live2d {
</span></span></span><span class="line"><span class="cl"><span class="sb">        display: block !important;
</span></span></span><span class="line"><span class="cl"><span class="sb">        visibility: visible !important;
</span></span></span><span class="line"><span class="cl"><span class="sb">        pointer-events: auto !important;
</span></span></span><span class="line"><span class="cl"><span class="sb">      }
</span></span></span><span class="line"><span class="cl"><span class="sb">      #waifu-tool {
</span></span></span><span class="line"><span class="cl"><span class="sb">        display: block !important;
</span></span></span><span class="line"><span class="cl"><span class="sb">        opacity: 1 !important;
</span></span></span><span class="line"><span class="cl"><span class="sb">        pointer-events: auto !important;
</span></span></span><span class="line"><span class="cl"><span class="sb">      }
</span></span></span><span class="line"><span class="cl"><span class="sb">      #waifu-tips {
</span></span></span><span class="line"><span class="cl"><span class="sb">        display: block !important;
</span></span></span><span class="line"><span class="cl"><span class="sb">        pointer-events: auto !important;
</span></span></span><span class="line"><span class="cl"><span class="sb">      }
</span></span></span><span class="line"><span class="cl"><span class="sb">    `</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">document</span><span class="p">.</span><span class="nx">head</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">style</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 清除可能导致问题的缓存
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="s2">&#34;modelId&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="s2">&#34;modelTexturesId&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&#34;Live2D初始化失败:&#34;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">&#34;建议检查网络连接或更换CDN源&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// 添加全局错误处理，防止Live2D错误导致页面崩溃
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 处理Live2D相关的错误
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">message</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span><span class="p">.</span><span class="nx">message</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;hitTest&#39;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">&#34;Live2D hitTest错误，已自动修复:&#34;</span><span class="p">,</span> <span class="nx">event</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span> <span class="c1">// 阻止错误传播
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 处理资源加载错误
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">filename</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">filename</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;live2d&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">event</span><span class="p">.</span><span class="nx">filename</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;textures.cache&#39;</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">&#34;Live2D资源加载错误，已自动处理:&#34;</span><span class="p">,</span> <span class="nx">event</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// 添加额外的检查和调试信息
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">waifuElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;waifu&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">live2dCanvas</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;live2d&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Live2D元素检查:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;- waifu元素存在:&#34;</span><span class="p">,</span> <span class="o">!!</span><span class="nx">waifuElement</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;- live2d画布存在:&#34;</span><span class="p">,</span> <span class="o">!!</span><span class="nx">live2dCanvas</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">waifuElement</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;- waifu类名:&#34;</span><span class="p">,</span> <span class="nx">waifuElement</span><span class="p">.</span><span class="nx">className</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;- waifu样式:&#34;</span><span class="p">,</span> <span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">waifuElement</span><span class="p">).</span><span class="nx">bottom</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">live2dCanvas</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;- 画布尺寸:&#34;</span><span class="p">,</span> <span class="nx">live2dCanvas</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="s2">&#34;x&#34;</span><span class="p">,</span> <span class="nx">live2dCanvas</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;- 画布样式:&#34;</span><span class="p">,</span> <span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">live2dCanvas</span><span class="p">).</span><span class="nx">display</span><span class="p">,</span> <span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">live2dCanvas</span><span class="p">).</span><span class="nx">visibility</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 如果画布存在但不可见，强制显示
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="nx">live2dCanvas</span> <span class="o">&amp;&amp;</span> <span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">live2dCanvas</span><span class="p">).</span><span class="nx">display</span> <span class="o">===</span> <span class="s1">&#39;none&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;强制显示Live2D画布&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">live2dCanvas</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">&#39;block&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nx">live2dCanvas</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">visibility</span> <span class="o">=</span> <span class="s1">&#39;visible&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 如果waifu元素存在但没有active类，添加它
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="nx">waifuElement</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">waifuElement</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="s1">&#39;waifu-active&#39;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;添加waifu-active类&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">waifuElement</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;waifu-active&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 如果Live2D加载失败，尝试降级方案
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">live2dCanvas</span> <span class="o">||</span> <span class="nx">live2dCanvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">&#34;Live2D模型加载失败，尝试降级显示&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 可以在这里添加降级的静态图片显示
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span> <span class="mi">3000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">})();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`
</span></span></span><span class="line"><span class="cl"><span class="sb">  く__,.ヘヽ.        /  ,ー､ 〉
</span></span></span><span class="line"><span class="cl"><span class="sb">           ＼ &#39;, !-─‐-i  /  /´
</span></span></span><span class="line"><span class="cl"><span class="sb">           ／｀ｰ&#39;       L/／｀ヽ､
</span></span></span><span class="line"><span class="cl"><span class="sb">         /   ／,   /|   ,   ,       &#39;,
</span></span></span><span class="line"><span class="cl"><span class="sb">       ｲ   / /-‐/  ｉ  L_ ﾊ ヽ!   i
</span></span></span><span class="line"><span class="cl"><span class="sb">        ﾚ ﾍ 7ｲ｀ﾄ   ﾚ&#39;ｧ-ﾄ､!ハ|   |
</span></span></span><span class="line"><span class="cl"><span class="sb">          !,/7 &#39;0&#39;     ´0iソ|    |
</span></span></span><span class="line"><span class="cl"><span class="sb">          |.从&#34;    _     ,,,, / |./    |
</span></span></span><span class="line"><span class="cl"><span class="sb">          ﾚ&#39;| i＞.､,,__  _,.イ /   .i   |
</span></span></span><span class="line"><span class="cl"><span class="sb">            ﾚ&#39;| | / k_７_/ﾚ&#39;ヽ,  ﾊ.  |
</span></span></span><span class="line"><span class="cl"><span class="sb">              | |/i 〈|/   i  ,.ﾍ |  i  |
</span></span></span><span class="line"><span class="cl"><span class="sb">             .|/ /  ｉ：    ﾍ!    ＼  |
</span></span></span><span class="line"><span class="cl"><span class="sb">              kヽ&gt;､ﾊ    _,.ﾍ､    /､!
</span></span></span><span class="line"><span class="cl"><span class="sb">              !&#39;〈//｀Ｔ´&#39;, ＼ ｀&#39;7&#39;ｰr&#39;
</span></span></span><span class="line"><span class="cl"><span class="sb">              ﾚ&#39;ヽL__|___i,___,ンﾚ|ノ
</span></span></span><span class="line"><span class="cl"><span class="sb">                  ﾄ-,/  |___./
</span></span></span><span class="line"><span class="cl"><span class="sb">                  &#39;ｰ&#39;    !_,.:
</span></span></span><span class="line"><span class="cl"><span class="sb">`</span><span class="p">);</span>
</span></span></code></pre></div><ol>
<li>
<p><strong>启用Live2D</strong>：在<code>config/_default/params.yml</code>中设置（这就是Reimu专属的配置文件了，别的主题我不清楚，所以推荐大家都来用这个主题喵！）：</p>
        
        <hr><p>Published on 2025-09-29 at <a href='https://nizigen.github.io/'>Chiyuki の CS Blog ですわ</a>, last modified on 2025-09-29</p>]]></description></item></channel></rss>